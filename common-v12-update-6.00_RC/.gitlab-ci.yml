variables:
  GIT_STRATEGY: none

stages:
  - Build
  - Update

LTS-v12_WilSonCity-TP02_FULL1:
  stage: Build
  image:
    name: amispx:v0.1
  tags:
    - "LTS-Build"
  retry:
    max: 2
    when:
      - runner_system_failure
      - job_execution_timeout
      - scheduler_failure
  script:
    - export Branch=LTS-v12
    - export CIOutput=$(pwd)/${CI_JOB_STAGE}_Output/${CI_JOB_NAME}
    - git clone https://git.ami.com/core/rd/active-tree/LTS /tmp/LTS        
    - cat /tmp/LTS/script/LTS-v12_WilSonCity-TP02_FULL1.sh
    - cd /tmp/LTS/script
    - source ./LTS-v12_WilSonCity-TP02_FULL1.sh

  artifacts:
    paths:
    - ${CI_JOB_STAGE}_Output/${CI_JOB_NAME}
    expire_in: 12 weeks
  only:
  - merge_requests
  except:
  - master

LTS-v12_MFP_Whitley-Update:
  stage: Update
  image:
    name: amispx:v0.1
  tags:
    - "LTS-Build"
  retry:
    max: 2
    when:
      - runner_system_failure
      - job_execution_timeout
      - scheduler_failure
  dependencies: []
  script:
    - git clone https://git.ami.com/core/rd/active-tree/LTS /tmp/LTS        
    - cd /tmp/LTS/script
    - source ./LTSUpdateSubmodule.sh Target=https://git.ami.com/core/lts/dev/ext-packs/optionalpack/mfp/mfp-ast2500.git Branch=LTS-v12
  only:
  - LTS-v12
  except:
  - master
